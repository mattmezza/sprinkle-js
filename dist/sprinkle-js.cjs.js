"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const E=e=>typeof e=="string"?document.querySelector(e):e,A=(e,t,n=[])=>{Object.entries(t).forEach(([i,o])=>{if(typeof o=="object"){A(e,o,[...n,i]);return}let c=e;if(n.forEach(a=>{c=c[a]}),n[n.length-1]==="style"&&i.startsWith("--")){c.setProperty(i,o);return}if(i==="className"&&e instanceof SVGElement){c.setAttribute("class",o.toString());return}if(n.length===0&&i.startsWith("data-")){e.setAttribute(i,o);return}c[i]=o})},V=(e,t)=>[...Array(e).keys()].map(()=>Array(t).fill(0)),M=(e=[],t=[],n=(s,i)=>s===i)=>{var a,u,b,h,l,f;const s=V(e.length+1,t.length+1);for(let r=0;r<e.length+1;r+=1)s[r][0]=r;for(let r=0;r<t.length+1;r+=1)s[0][r]=r;for(let r=0;r<e.length;r+=1)for(let m=0;m<t.length;m+=1)if(n(e[r],t[m]))s[r+1][m+1]=s[r][m];else{const L=Math.min(s[r+1][m],s[r][m+1])+1;s[r+1][m+1]=L}const i=[];let o=e.length,c=t.length;for(;o>0&&c>0;)n(e[o-1],t[c-1])?(i.unshift({type:"=",value:e[o-1],skip:!1}),c-=1,o-=1):s[o-1][c]<s[o][c-1]?(i.unshift({type:"-",value:e[o-1],skip:!1}),o-=1):(i.unshift({type:"+",value:t[c-1],skip:!1}),c-=1);return o>0?i.unshift(...((b=(u=(a=e==null?void 0:e.slice)==null?void 0:a.call(e,0,o))==null?void 0:u.map)==null?void 0:b.call(u,r=>({type:"-",value:r,skip:!1})))||[]):c>0&&i.unshift(...((f=(l=(h=t==null?void 0:t.slice)==null?void 0:h.call(t,0,c))==null?void 0:l.map)==null?void 0:f.call(l,r=>({type:"+",value:r,skip:!1})))||[]),i},v=(e,t,n=0)=>e.find((s,i,...o)=>i>n&&t(s,i,...o)),j=e=>Object.prototype.toString.call(e).slice(8,-1),N=e=>{const t=document.createElement("template");return Object.assign(t,{innerHTML:e}),t.content},_=(e,t)=>e.getAttribute(t),p=e=>e instanceof Element?_(e,"key"):e.textContent;let y=[];const O=Symbol("is-reactive"),C=Symbol("memo");let S=null;const T=e=>{[...e].forEach(t=>{if(!t.toRun)return;const n=t.execute();n&&(t.cleanup=n)})},P=e=>{S=new Set;try{e()}finally{const t=new Set(S);S=null,T(t)}},U=(e,t,n)=>{let s=n.get(e);s||(s=new Set,n.set(e,s)),s.add(t),t.dependencies.add(s)},F=(e,t)=>{const n=e.get(t);if(!!n){if(S!==null){n.forEach(s=>S.add(s));return}T(n)}},H=(e,t)=>{if(e[O])return e;if(typeof e!="object")throw new Error("It's not possible to create a variable from a primitive value...you can use createRef");Object.keys(e||{}).forEach(o=>{const c=o;!!e[c]&&typeof e[c]=="object"&&(j(e[c])==="Object"||Array.isArray(e[c]))&&(e[c]=w(e[c],t==null?void 0:t[c]))});const s=new Map;return new Proxy(e,{get:(...o)=>{if(o[1]===O)return!0;const c=y[y.length-1];return c&&U(o[1],c,s),Reflect.get(...o)},set:(o,c,a)=>{var r;if(o[C]===!1&&c!==C)return!0;const u=c,b=(r=t==null?void 0:t[u])!=null?r:Object.is;let h=a;!!a&&typeof a=="object"&&(j(a)==="Object"||Array.isArray(a))&&!a[O]&&(h=w(a,b));const l=b(o[u],a),f=Reflect.set(o,c,h);return l||F(s,c),f}})},J=(e,t,n=":root")=>{const s=w(e,t);let i=E(n);return i||(console.warn("Impossible to find the right html element, attaching the variables to the root."),i=document.querySelector(":root")),d(()=>{Object.keys(s).forEach(c=>{var a;i.style.setProperty(`--${c}`,(a=s[c])==null?void 0:a.toString())})}),s},$=(e,t)=>{const n={value:e(),[C]:!1},s=w(n,t?{value:t}:void 0);return d(()=>{s[C]=!0,s.value=e(),s[C]=!1}),s},D=(e,t,n,s=window.localStorage)=>{if(typeof t!="object")throw new Error("It's not possible to create a variable from a primitive value...you can use createRef");let i=null;try{const c=s.getItem(e);c?i=JSON.parse(c):s.setItem(e,JSON.stringify(t))}catch{throw new Error("The specified key is associated with a non Object-like element")}const o=w(i!=null?i:t,n);return d(()=>{s.setItem(e,JSON.stringify(o))}),window.addEventListener("storage",c=>{if(c.storageArea===s&&c.key===e)try{if(c.newValue){const a=JSON.parse(c.newValue);Object.keys(a).forEach(b=>{o[b]=a[b]})}}catch{console.warn("The storage was modified but the resulting object is not parsable...the variable was not updated.")}}),o},W=(e,t)=>w({value:e},t?{value:t}:void 0),R=e=>{e.owned.forEach(t=>{t.toRun=!1,R(t)}),e.dependencies.forEach(t=>{t.delete(e)}),e.dependencies.clear()},B=e=>{const t=()=>{var o,c,a;if(!n.toRun)return;(a=(c=(o=n==null?void 0:n.owner)==null?void 0:o.owned)==null?void 0:c.push)==null||a.call(c,n),n.cleanup&&typeof n.cleanup=="function"&&n.cleanup(),R(n),y.push(n);let i;try{i=e()}finally{y.pop()}return i},n={execute:t,dependencies:new Set,owned:[],owner:y[y.length-1],toRun:!0},s=t();s&&(n.cleanup=s)},g={createVariable:H,createEffect:B,createComputed:$};let k={...g};const w=(e,t)=>k.createVariable(e,t),d=e=>k.createEffect(e),G=(e,t)=>k.createComputed(e,t),Q=(e=g)=>(Object.keys(e).forEach(t=>{k[t]=e[t]}),()=>{k=g}),Y=e=>{const t=y;y=[];const n=e();return y=t,n},z=(e,t)=>{const n=E(e);return d(()=>{n&&(n.textContent=t(n))}),n},X=(e,t)=>{const n=E(e);return d(()=>{n&&(n.innerHTML=t(n))}),n},Z=(e,t,n)=>{const s=E(e);return d(()=>{s&&(n(s)?s.classList.add(t):s.classList.remove(t))}),s},K=(e,t)=>{const n=E(e);return d(()=>{if(n){const s=t(n);Object.keys(s||{}).forEach(o=>{s[o]?n.classList.add(o):n.classList.remove(o)})}}),n},q=(e,t)=>{const n=E(e);return d(()=>{n&&(n.value=t(n))}),n},x=(e,t)=>{const n=E(e);return d(()=>A(n,t(n))),n},ee=(e,t)=>{const n=E(e);if(!!n)return x(n,()=>({style:t(n)})),n},I=(e,t,n)=>{const s=E(e);return d(()=>{if(s===null)return;const i=t(s),o=N(i).childNodes,c=new Map,a=(l,f=!0)=>{const r=p(l);r!=null&&c.set(r,{element:l,isNew:f})};if(s.children.length===0){const l=Array.from(o);s.append(...l),l.forEach(f=>a(f)),typeof n=="function"&&d(()=>{n(s,c)});return}const u=M(Array.from(s.childNodes),Array.from(o),(l,f)=>p(l)!=null&&p(f)!=null?p(l)===p(f):l===f);let b=u.find(l=>l.type==="="),h=0;u.forEach(l=>{if(l.type==="+"){const f=v(u,r=>r.type==="-"&&p(r.value)===p(l.value),h);if(f&&(l.value=f.value,f.skip=!0),!b){s.append(l.value),a(l.value),h+=1;return}b.value.before(l.value),a(l.value)}else if(l.type==="-"){if(l.skip){h+=1;return}s.removeChild(l.value);const f=v(u,r=>r.type==="+"&&p(r.value)===p(l.value),h);f&&(f.value=l.value)}else b=v(u,f=>f.type==="=",h),a(l.value,!1);h+=1}),typeof n=="function"&&d(()=>{n(s,c)})}),s},te=(e,t,n)=>(console.warn(`${t}${n?`See more at ${n}`:""}`),e),ne=te(I,"'bindChildrens' is deprecated: please use 'bindChildren' instead.",new URL("https://github.com/paoloricciuti/sprinkle-js/issues/3"));exports.batch=P;exports.bindChildren=I;exports.bindChildrens=ne;exports.bindClass=Z;exports.bindClasses=K;exports.bindDom=x;exports.bindInnerHTML=X;exports.bindInputValue=q;exports.bindStyle=ee;exports.bindTextContent=z;exports.createComputed=G;exports.createCssVariable=J;exports.createEffect=d;exports.createRef=W;exports.createStored=D;exports.createVariable=w;exports.setup=Q;exports.untrack=Y;
